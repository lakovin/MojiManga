<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <title>–ö–∞—Ç–∞–ª–æ–≥ –ú–∞–Ω–≥–∏ ‚Äî Moji</title>
    <link rel="stylesheet" href="styles.css" />
</head>
<body>
    <header>
        <div class="logo"><a href="index.html">Moji</a></div>
        <nav>
            <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
            <a href="catalog.html">–ö–∞—Ç–∞–ª–æ–≥</a>
            <a href="about.html">–û —Å–∞–π—Ç–µ</a>
        </nav>
        <button id="themeToggle" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer;">üåô</button>
    </header>

    <main class="catalog">
        <h2>–ö–∞—Ç–∞–ª–æ–≥ –ú–∞–Ω–≥–∏</h2>

        <input type="text"
               id="searchInput"
               placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é..."
               style="width: 100%; max-width: 400px; padding: 10px; font-size: 16px; margin-bottom: 20px;" />

        <!-- –ö–Ω–æ–ø–∫–∏ –∂–∞–Ω—Ä–æ–≤ -->
        <div id="genreFilters" style="margin-bottom: 20px;"></div>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ -->
        <div class="card-grid" id="catalogGrid"></div>
    </main>

    <footer>
        <p>&copy; 2025 Moji ‚Äî –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã</p>
    </footer>

    <script src="mangaData.js"></script>
    <script>
        const catalogGrid = document.getElementById("catalogGrid");
        const searchInput = document.getElementById("searchInput");
        const genreFilters = document.getElementById("genreFilters");
        const themeToggle = document.getElementById("themeToggle");

        let currentGenre = "–í—Å–µ";
        let currentSearch = "";

        // –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é —Ç–µ–º—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        if (localStorage.getItem("theme") === "dark") {
            document.body.classList.add("dark");
            themeToggle.textContent = "‚òÄÔ∏è";
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
        themeToggle.addEventListener("click", () => {
            document.body.classList.toggle("dark");
            const isDark = document.body.classList.contains("dark");
            themeToggle.textContent = isDark ? "‚òÄÔ∏è" : "üåô";
            localStorage.setItem("theme", isDark ? "dark" : "light");
        });

        // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –∂–∞–Ω—Ä—ã –∏–∑ —Å–ø–∏—Å–∫–∞
        const genreSet = new Set();
        mangaList.forEach(m => m.genres.forEach(g => genreSet.add(g)));
        const genres = ["–í—Å–µ", ...genreSet];

        // –†–µ–Ω–¥–µ—Ä –∫–Ω–æ–ø–æ–∫ –∂–∞–Ω—Ä–æ–≤
        genres.forEach(genre => {
            const btn = document.createElement("button");
            btn.textContent = genre;
            btn.style.marginRight = "10px";
            btn.style.marginBottom = "10px";
            btn.style.padding = "8px 16px";
            btn.style.border = "none";
            btn.style.borderRadius = "6px";
            btn.style.cursor = "pointer";
            btn.style.background = "#eee";

            btn.addEventListener("click", () => {
                currentGenre = genre;
                renderCards();
            });

            genreFilters.appendChild(btn);
        });

        // –†–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫
        function renderCards() {
            catalogGrid.innerHTML = "";

            const filtered = mangaList.filter(manga => {
                const matchTitle = manga.title.toLowerCase().includes(currentSearch);
                const matchGenre = currentGenre === "–í—Å–µ" || manga.genres.includes(currentGenre);
                return matchTitle && matchGenre;
            });

            filtered.forEach(manga => {
                const card = document.createElement("a");
                card.href = `reader.html?manga=${manga.code}&chapter=1`;
                card.className = "card-link";
                card.innerHTML = `
                    <div class="card">
                        <img src="${manga.image}" alt="${manga.title}">
                        <h3>${manga.title}</h3>
                        <p>${manga.genres.join(", ")}</p>
                    </div>
                `;
                catalogGrid.appendChild(card);
            });
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–∏—Å–∫–∞
        searchInput.addEventListener("input", () => {
            currentSearch = searchInput.value.toLowerCase();
            renderCards();
        });

        // –ü–µ—Ä–≤–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞
        renderCards();
    </script>

</body>
</html>
